<!-- Backdrop -->
<div 
  class="modal-backdrop fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center p-4"
  (click)="onBackdropClick($event)"
  (keydown)="onEscapeKey($event)"
  tabindex="0"
>
  <!-- Modal Container -->
  <div 
    class="modal-container bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden animate-slideIn"
    (click)="$event.stopPropagation()"
  >
    <!-- Header -->
    <div class="modal-header bg-gradient-to-r from-indigo-500 to-indigo-600 px-6 py-5 flex items-center justify-between">
      <h2 class="text-2xl font-bold text-white flex items-center gap-2">
        <mat-icon class="text-white">business</mat-icon>
        Crear Consorcio
      </h2>
      <button
        (click)="onClose()"
        class="text-white hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-colors"
        type="button"
      >
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <!-- Formulario -->
    <div class="modal-body overflow-y-auto max-h-[calc(90vh-200px)] px-6 py-6">
      <form [formGroup]="form" class="flex flex-col gap-4">

      <div class="form-group">
        <label class="font-semibold text-gray-700">Código Externo</label>
        <input formControlName="codigo_ext" class="input" placeholder="" />
      </div>

        <div>
          <label class="font-semibold text-gray-700">Nombre del Consorcio *</label>
          <input formControlName="nombre" class="input" placeholder="Ej. Torre San Martín" />
        </div>

        <div>
          <label class="font-semibold text-gray-700">Dirección *</label>
          <input formControlName="direccion" class="input" placeholder="Av. Corrientes 1234" />
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label class="font-semibold text-gray-700">Ciudad</label>
            <input formControlName="ciudad" class="input" placeholder="Ej. CABA" />
          </div>
          <div>
            <label class="font-semibold text-gray-700">Provincia</label>
            <input formControlName="provincia" class="input" placeholder="Ej. Buenos Aires" />
          </div>
        </div>

        <div>
          <label class="font-semibold text-gray-700">Responsable del edificio</label>
          <div class="flex gap-2">
            <select formControlName="responsable_id" class="input flex-1">
              <option [ngValue]="null">Seleccione...</option>
              <option *ngFor="let r of responsables" [ngValue]="r.id">
                {{ r.nombre }} {{ r.apellido }}
              </option>
            </select>
            <button type="button" (click)="crearResponsableNuevo()" 
              class="bg-indigo-500 text-white rounded-lg px-3 py-2 hover:bg-indigo-600">
              + Nuevo
            </button>
          </div>
        </div>

      </form>
    </div>

    <!-- Footer -->
    <div class="modal-footer flex justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50">
      <button (click)="onClose()" class="btn-secondary">Cancelar</button>
      <button (click)="onSubmit()" class="btn-primary">Guardar</button>
    </div>
  </div>
</div>
